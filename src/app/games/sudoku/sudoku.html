<div class="sudoku-card">
  <form class="toolbar" (ngSubmit)="load()">
    <label class="control">
      <span>Svårighetsgrad</span>
      <select [(ngModel)]="selectedDifficulty" name="difficulty">
        @for (d of difficulties; track d) {
          <option [value]="d">{{ d | titlecase }}</option>
        }
      </select>
    </label>

    <button type="submit" [disabled]="loading">
      {{ loading ? 'Hämtar…' : 'Hämta Sudoku' }}
    </button>
  </form>

  @if (sudoku) {
    <div class="meta">
      <span>Difficulty:</span>
      <strong>{{ sudoku.difficulty ?? selectedDifficulty | titlecase }}</strong>
    </div>
  }

  @if (error) {
    <p class="error">{{ error }}</p>
  }

  @if (sudoku; as s) {
    <div class="board-wrap">
      <table class="sudoku" aria-label="Sudokobräde">
        <tbody>
          @for (row of s.grid; track trackRow(r, row); let r = $index) {
            <tr>
              @for (cell of row; track trackCol(c, cell); let c = $index) {
                <td>
                  @if (givenMask[r][c]) {
                    <span class="cell given">{{ cell }}</span>
                  }
                  @if (!givenMask[r][c]) {
                    <input
                      class="cell editable"
                      type="text"
                      maxlength="1"
                      inputmode="numeric"
                      autocomplete="off"
                      [value]="cellText(cell)"
                      (input)="onCellInput(r, c, $any($event.target).value)"
                      />
                  }
                </td>
              }
            </tr>
          }
        </tbody>
      </table>
    </div>
  }

  @if (mistakes > 0) {
    <p class="mistakes">Fel: {{ mistakes }}</p>
  }
</div>
