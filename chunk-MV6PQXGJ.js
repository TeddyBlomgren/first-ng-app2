import{i as T,j as B}from"./chunk-GYORGMM7.js";import"./chunk-FPPZ4BUR.js";import{Cb as I,Fa as E,Gb as A,Ka as h,O as D,Ua as O,Y as _,Z as M,bb as p,cb as a,db as c,ib as S,jb as P,kb as R,lb as v,nb as m,sb as F,tb as j,ua as u,ub as d,wb as w,za as k}from"./chunk-A7UPANQH.js";var y=(t=>(t.Easy="easy",t.Medium="medium",t.Hard="hard",t))(y||{}),b=class s{static PRESETS={easy:{rows:8,cols:8,minePercent:.12},medium:{rows:12,cols:12,minePercent:.16},hard:{rows:16,cols:16,minePercent:.2}};rows=8;cols=8;mines=10;difficulty="easy";board=[];gameOver=!1;firstClick=!0;revealedCount=0;constructor(){this.reset()}setDifficulty(i){this.difficulty=i;let e=s.PRESETS[i];this.rows=e.rows,this.cols=e.cols;let t=this.rows*this.cols,n=Math.round(t*e.minePercent);this.mines=Math.min(Math.max(1,n),t-1),this.reset()}reset(){this.board=this.generateBoard(),this.gameOver=!1,this.firstClick=!0,this.revealedCount=0}generateBoard(){let i=Array.from({length:this.rows},()=>Array.from({length:this.cols},()=>({hasMine:!1,isRevealed:!1,isFlagged:!1,adjacentMines:0}))),e=0;for(;e<this.mines;){let t=Math.floor(Math.random()*this.rows),n=Math.floor(Math.random()*this.cols);i[t][n].hasMine||(i[t][n].hasMine=!0,e++)}for(let t=0;t<this.rows;t++)for(let n=0;n<this.cols;n++)i[t][n].hasMine?i[t][n].adjacentMines=0:i[t][n].adjacentMines=this.countAdjacentMines(i,t,n);return i}countAdjacentMines(i,e,t){let n=0;for(let r=-1;r<=1;r++)for(let o=-1;o<=1;o++){if(r===0&&o===0)continue;let l=e+r,f=t+o;this.inBounds(l,f)&&i[l][f].hasMine&&n++}return n}reveal(i,e){if(this.gameOver)return;let t=this.getCell(i,e);if(!(!t||t.isRevealed||t.isFlagged)){if(this.firstClick&&t.hasMine){this.moveMineAway(i,e);for(let n=0;n<this.rows;n++)for(let r=0;r<this.cols;r++)this.board[n][r].hasMine?this.board[n][r].adjacentMines=0:this.board[n][r].adjacentMines=this.countAdjacentMines(this.board,n,r)}this.firstClick=!1,this.floodReveal(i,e),!this.gameOver&&this.checkWin()&&(this.gameOver=!0)}}toggleFlag(i,e){if(this.gameOver)return;let t=this.getCell(i,e);!t||t.isRevealed||(t.isFlagged=!t.isFlagged)}isGameOver(){return this.gameOver}floodReveal(i,e){let t=[[i,e]];for(;t.length;){let[n,r]=t.pop(),o=this.getCell(n,r);if(!(!o||o.isRevealed||o.isFlagged)){if(o.isRevealed=!0,o.hasMine){this.gameOver=!0;continue}if(this.revealedCount++,o.adjacentMines===0)for(let l=-1;l<=1;l++)for(let f=-1;f<=1;f++){if(l===0&&f===0)continue;let C=n+l,x=r+f,g=this.getCell(C,x);g&&!g.isRevealed&&!g.isFlagged&&!g.hasMine&&t.push([C,x])}}}}moveMineAway(i,e){this.board[i][e].hasMine=!1;for(let t=0;t<this.rows;t++)for(let n=0;n<this.cols;n++)if(!this.board[t][n].hasMine&&!(t===i&&n===e)){this.board[t][n].hasMine=!0;return}}checkWin(){let i=this.rows*this.cols-this.mines;return this.revealedCount>=i}inBounds(i,e){return i>=0&&i<this.rows&&e>=0&&e<this.cols}getCell(i,e){return this.inBounds(i,e)?this.board[i][e]:null}getBoard(){return this.board}getRows(){return this.rows}getCols(){return this.cols}getMines(){return this.mines}getDifficulty(){return this.difficulty}static \u0275fac=function(e){return new(e||s)};static \u0275prov=D({token:s,factory:s.\u0275fac,providedIn:"root"})};function $(s,i){if(s&1&&(S(0),d(1),P()),s&2){let e=m().$implicit;u(),w(" ",e.hasMine?"\u{1F4A3}":e.adjacentMines||""," ")}}function z(s,i){if(s&1&&d(0),s&2){let e=m().$implicit;w(" ",e.isFlagged?"\u{1F6A9}":""," ")}}function L(s,i){if(s&1){let e=R();a(0,"button",11),v("click",function(){let n=_(e).index,r=m().index,o=m();return M(o.onLeftClick(r,n))})("contextmenu",function(n){let r=_(e).index,o=m().index,l=m();return M(l.onRightClick(n,o,r))}),h(1,$,2,1,"ng-container",12)(2,z,1,1,"ng-template",null,0,A),c()}if(s&2){let e=i.$implicit,t=i.index,n=F(3),r=m().index;j("revealed",e.isRevealed)("mine",e.isRevealed&&e.hasMine)("flagged",e.isFlagged),O("aria-label",I("Ruta ",r+1,", ",t+1)),u(),p("ngIf",e.isRevealed)("ngIfElse",n)}}function W(s,i){if(s&1&&(a(0,"div",9),h(1,L,4,11,"button",10),c()),s&2){let e=i.$implicit;u(),p("ngForOf",e)}}var V=class s{constructor(i){this.game=i}Difficulty=y;get board(){return this.game.getBoard()}onLeftClick(i,e){this.game.reveal(i,e)}onRightClick(i,e,t){i.preventDefault(),this.game.toggleFlag(e,t)}setDifficulty(i){this.game.setDifficulty(i)}reset(){this.game.reset()}static \u0275fac=function(e){return new(e||s)(k(b))};static \u0275cmp=E({type:s,selectors:[["app-minesweeper"]],decls:17,vars:4,consts:[["hidden",""],[1,"game"],[1,"game-title"],[1,"minesweeper-controls"],[3,"change"],[3,"value"],[3,"click"],[1,"minesweeper-board"],["class","row",4,"ngFor","ngForOf"],[1,"row"],["class","cell",3,"revealed","mine","flagged","aria-label","click","contextmenu",4,"ngFor","ngForOf"],[1,"cell",3,"click","contextmenu","aria-label"],[4,"ngIf","ngIfElse"]],template:function(e,t){e&1&&(a(0,"div",1)(1,"h1",2),d(2,"Minesweeper"),c(),a(3,"div",3)(4,"label"),d(5,"Sv\xE5righet: "),a(6,"select",4),v("change",function(r){return t.setDifficulty(r.target.value)}),a(7,"option",5),d(8,"Easy"),c(),a(9,"option",5),d(10,"Medium"),c(),a(11,"option",5),d(12,"Hard"),c()()(),a(13,"button",6),v("click",function(){return t.reset()}),d(14,"\u{1F504} Starta om"),c()(),a(15,"div",7),h(16,W,2,1,"div",8),c()()),e&2&&(u(7),p("value",t.Difficulty.Easy),u(2),p("value",t.Difficulty.Medium),u(2),p("value",t.Difficulty.Hard),u(5),p("ngForOf",t.board))},dependencies:[T,B],styles:["body[_ngcontent-%COMP%]{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}.game[_ngcontent-%COMP%]{min-height:auto;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px}.game-title[_ngcontent-%COMP%]{margin:0;font-size:2rem;font-weight:700}.minesweeper-controls[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center;justify-content:center}.minesweeper-board[_ngcontent-%COMP%]{display:block;border:2px solid #333;background:#f9f9f9;padding:12px;border-radius:8px}.row[_ngcontent-%COMP%]{display:flex}.cell[_ngcontent-%COMP%]{width:32px;height:32px;margin:2px;font-size:1.1rem;background:#e0e0e0;border:1px solid #888;border-radius:4px;cursor:pointer;outline:none;-webkit-user-select:none;user-select:none;display:flex;justify-content:center;align-items:center;transition:background .1s}.cell[_ngcontent-%COMP%]:active:not(.revealed){background:#d0d0d0}.cell.revealed[_ngcontent-%COMP%]{background:#fff;border-color:#aaa}.cell.mine[_ngcontent-%COMP%]{background:#f5b5b5}.cell.flagged[_ngcontent-%COMP%]{background:#e0e0e0}"]})};export{V as Minesweeper};
